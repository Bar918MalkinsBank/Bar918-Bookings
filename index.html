<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Book a Table - Bar918</title>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    (function() {
      emailjs.init("aypCqsVVHRqzqReCk");
    })();
  </script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #faf9f6;
      color: #012C4E;
      text-align: center;
      padding: 20px;
    }
    h1 { color: #012C4E; }
    form {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      max-width: 500px;
      margin: 0 auto;
    }
    input, select, textarea, button {
      width: 100%;
      margin-bottom: 10px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
    }
    button {
      background-color: #012C4E;
      color: white;
      cursor: pointer;
      font-weight: bold;
    }
    button:hover { background-color: #021a33; }

    .layout {
      display: flex;
      justify-content: center;
      align-items: start;
      gap: 60px;
      flex-wrap: wrap;
      margin-bottom: 30px;
    }
    .divider {
      height: 360px;
      width: 6px;
      background-color: #5C2C06;
      border-radius: 3px;
      align-self: center;
    }
    .section {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 24px;
      justify-items: center;
    }
    .snug {
      display: flex;
      justify-content: center;
      margin-top: 30px;
      gap: 24px;
    }
    .table-btn {
      background-color: #EAD292;
      border: none;
      padding: 18px 0;
      border-radius: 10px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.25s ease;
      width: 100px;
      height: 70px;
      font-size: 15px;
      line-height: 1.2;
    }
    .table-btn.selected { border: 3px solid #012C4E; }
  </style>
</head>
<body>

  <h1>Book a Table at Bar918</h1>

  <div class="layout">
    <div class="section" id="left-section">
      <button class="table-btn" data-table="7" data-seats="4">7 (4)</button>
      <button class="table-btn" data-table="8" data-seats="4">8 (4)</button>
      <button class="table-btn" data-table="9" data-seats="4">9 (4)</button>
      <button class="table-btn" data-table="10" data-seats="4">10 (4)</button>
      <button class="table-btn" data-table="11" data-seats="4">11 (4)</button>
      <button class="table-btn" data-table="12" data-seats="4">12 (4)</button>
      <button class="table-btn" data-table="13" data-seats="4">13 (4)</button>
      <button class="table-btn" data-table="14" data-seats="6">14 (6)</button>
      <button class="table-btn" data-table="15" data-seats="4">15 (4)</button>
    </div>
    <div class="divider"></div>
    <div class="section" id="right-section">
      <button class="table-btn" data-table="1" data-seats="4">1 (4)</button>
      <button class="table-btn" data-table="2" data-seats="6">2 (6)</button>
      <button class="table-btn" data-table="3" data-seats="4">3 (4)</button>
      <button class="table-btn" data-table="4" data-seats="4">4 (4)</button>
      <button class="table-btn" data-table="5" data-seats="4">5 (4)</button>
      <button class="table-btn" data-table="6" data-seats="6">6 (6)</button>
    </div>
  </div>

  <div class="snug">
    <button class="table-btn" data-table="S1" data-seats="2">Snug 1 (2)</button>
    <button class="table-btn" data-table="S2" data-seats="2">Snug 2 (2)</button>
    <button class="table-btn" data-table="S3" data-seats="2">Snug 3 (2)</button>
  </div>

  <form id="bookingForm">
    <input type="hidden" name="table" id="selectedTable" required />
    <input type="hidden" name="seats" id="selectedSeats" required />
    <input type="text" name="name" placeholder="Full Name" required />
    <input type="email" name="email" placeholder="Email Address" required />
    <input type="tel" name="phone" placeholder="Phone Number" required />
    <input type="date" name="date" required />
    <input type="time" name="time" required min="10:00" max="20:00" />
    <select name="babySeat" required>
      <option value="">Baby Seat?</option>
      <option value="Yes">Yes</option>
      <option value="No">No</option>
    </select>
    <textarea name="specialRequests" placeholder="Special Requests"></textarea>
    <button type="submit">Book Table</button>
  </form>

  <script>
    const WEBHOOK_URL = 'https://script.google.com/macros/s/AKfycbxALplsL1YhvjozZcJrd68-wZ_J8lG0IavP-B9xY26LD8ug7KnTAF5_gOcC3S5Ktp5S/exec';
    const tableButtons = document.querySelectorAll('.table-btn');
    let selectedTable = null;

    tableButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        tableButtons.forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        selectedTable = btn.dataset.table;
        document.getElementById('selectedTable').value = selectedTable;
        document.getElementById('selectedSeats').value = btn.dataset.seats;
      });
    });

    document.getElementById('bookingForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      const formData = Object.fromEntries(new FormData(e.target).entries());

      if (!formData.table) {
        alert("Please select a table first!");
        return;
      }

      const response = await fetch(WEBHOOK_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'text/plain;charset=utf-8' },
        body: JSON.stringify(formData)
      });

      const result = await response.text();

      if (result.includes('rejected')) {
        alert("Sorry, this time or date isn't available.");
        return;
      }

      emailjs.send("Service_Reservations", "Table_Template", {
        name: formData.name,
        date: formData.date,
        time: formData.time,
        table: formData.table,
        seats: formData.seats,
        babySeat: formData.babySeat,
        specialRequests: formData.specialRequests,
        email: formData.email,
      });

      alert("Booking successful! Confirmation email sent.");
      e.target.reset();
      tableButtons.forEach(b => b.classList.remove('selected'));
    });
  </script>
</body>
</html>
