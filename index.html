<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bar918 Table Booking</title>
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>
(function(){
  emailjs.init("aypCqsVVHRqzqReCk");
})();
</script>
</head>
<body style="background:transparent;font-family:Arial,sans-serif;text-align:center;color:#fff;">

<h2 style="color:#EAD292;">Book a Table at Bar918</h2>
<p style="margin-bottom:20px;">Select your table and fill out your booking details.</p>

<!-- Table Layout -->
<div style="display:flex;justify-content:center;align-items:flex-start;gap:40px;margin-bottom:20px;">

  <!-- Left Section -->
  <div style="display:flex;flex-direction:column;align-items:center;gap:10px;">
    <div style="display:grid;grid-template-columns:repeat(2,90px);gap:12px;">
      <button onclick="selectTable(this)" data-table="1" style="width:90px;height:60px;">Table 1<br>4 seats</button>
      <button onclick="selectTable(this)" data-table="2" style="width:90px;height:60px;">Table 2<br>4 seats</button>
      <button onclick="selectTable(this)" data-table="3" style="width:90px;height:60px;">Table 3<br>4 seats</button>
      <button onclick="selectTable(this)" data-table="4" style="width:90px;height:60px;">Table 4<br>4 seats</button>
    </div>
    <div style="margin-top:15px;display:flex;gap:12px;">
      <button onclick="selectTable(this)" data-table="S1" style="width:90px;height:50px;">Snug 1<br>2 seats</button>
      <button onclick="selectTable(this)" data-table="S2" style="width:90px;height:50px;">Snug 2<br>2 seats</button>
      <button onclick="selectTable(this)" data-table="S3" style="width:90px;height:50px;">Snug 3<br>2 seats</button>
    </div>
  </div>

  <!-- Divider -->
  <div style="width:3px;height:250px;background-color:#5a2d0c;border-radius:3px;"></div>

  <!-- Right Section -->
  <div style="display:grid;grid-template-columns:repeat(2,90px);gap:12px;">
    <button onclick="selectTable(this)" data-table="5" style="width:90px;height:60px;">Table 5<br>4 seats</button>
    <button onclick="selectTable(this)" data-table="6" style="width:90px;height:60px;">Table 6<br>6 seats</button>
    <button onclick="selectTable(this)" data-table="7" style="width:90px;height:60px;">Table 7<br>6 seats</button>
    <button onclick="selectTable(this)" data-table="8" style="width:90px;height:60px;">Table 8<br>4 seats</button>
  </div>
</div>

<!-- Booking Form -->
<form id="bookingForm" style="max-width:400px;margin:auto;">
  <input type="hidden" id="selectedTable" required>

  <label>Date:</label><br>
  <input type="date" id="date" required><br><br>

  <label>Time:</label><br>
  <input type="time" id="time" required><br><br>

  <label>Name:</label><br>
  <input type="text" id="name" required><br><br>

  <label>Contact Number:</label><br>
  <input type="tel" id="contact" required><br><br>

  <label>Email:</label><br>
  <input type="email" id="email" required><br><br>

  <label>Baby Seat?</label><br>
  <select id="babySeat" required>
    <option value="No">No</option>
    <option value="Yes">Yes</option>
  </select><br><br>

  <label>Special Requests:</label><br>
  <textarea id="notes" rows="3" style="width:100%;"></textarea><br><br>

  <button type="submit" style="background-color:#012C4E;color:#fff;padding:10px 20px;border:none;border-radius:4px;cursor:pointer;">
    Book Now
  </button>
</form>

<p id="statusMessage"></p>

<script>
const WEBHOOK_URL = "https://script.google.com/macros/s/AKfycbxALplsL1YhvjozZcJrd68-wZ_J8lG0IavP-B9xY26LD8ug7KnTAF5_gOcC3S5Ktp5S/exec";
let selectedButton = null;

function selectTable(btn) {
  if (selectedButton) {
    selectedButton.style.backgroundColor = '';
    selectedButton.style.color = '#000';
  }
  btn.style.backgroundColor = '#012C4E';
  btn.style.color = '#fff';
  selectedButton = btn;
  document.getElementById("selectedTable").value = btn.dataset.table;
}

document.getElementById("bookingForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const data = {
    table: document.getElementById("selectedTable").value,
    date: document.getElementById("date").value,
    time: document.getElementById("time").value,
    name: document.getElementById("name").value,
    contact: document.getElementById("contact").value,
    email: document.getElementById("email").value,
    babySeat: document.getElementById("babySeat").value,
    notes: document.getElementById("notes").value,
  };

  try {
    await fetch(WEBHOOK_URL, {
      method: "POST",
      headers: { "Content-Type": "text/plain;charset=utf-8" },
      body: JSON.stringify(data),
    });

    // Send to customer
    emailjs.send("Service_Reservations", "Table_Template", {
      to_email: data.email,
      to_name: data.name,
      table: data.table,
      date: data.date,
      time: data.time,
      contact: data.contact,
    });

    // Send to bar
    emailjs.send("Service_Reservations", "Table_Template", {
      to_email: "bar918.malkinsbank@gmail.com",
      to_name: "Bar918",
      table: data.table,
      date: data.date,
      time: data.time,
      contact: data.contact,
    });

    document.getElementById("statusMessage").innerText = "Booking submitted successfully!";
  } catch (err) {
    document.getElementById("statusMessage").innerText = "Error submitting booking.";
    console.error(err);
  }
});
</script>
</body>
</html>
