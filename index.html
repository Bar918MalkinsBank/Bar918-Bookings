<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bar918 Table Booking</title>
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>
(function(){
  emailjs.init("aypCqsVVHRqzqReCk");
})();
</script>
</head>
<body style="background:transparent;font-family:Arial;text-align:center;color:#fff;">

<h2>Book a Table at Bar918</h2>
<p>Select a table, fill in your details, and we'll confirm your booking.</p>

<!-- Table Layout -->
<div id="tableLayout" style="display:flex;flex-wrap:wrap;justify-content:center;gap:12px;margin-bottom:20px;">
  <button onclick="selectTable(this)" data-table="1" style="width:80px;height:80px;">1<br>4 seats</button>
  <button onclick="selectTable(this)" data-table="2" style="width:80px;height:80px;">2<br>6 seats</button>
  <button onclick="selectTable(this)" data-table="3" style="width:80px;height:80px;">3<br>4 seats</button>
  <button onclick="selectTable(this)" data-table="4" style="width:80px;height:80px;">4<br>4 seats</button>
  <button onclick="selectTable(this)" data-table="5" style="width:80px;height:80px;">5<br>4 seats</button>
  <button onclick="selectTable(this)" data-table="6" style="width:80px;height:80px;">6<br>6 seats</button>
  <button onclick="selectTable(this)" data-table="7" style="width:80px;height:80px;">7<br>6 seats</button>
  <button onclick="selectTable(this)" data-table="8" style="width:80px;height:80px;">8<br>4 seats</button>
  <button onclick="selectTable(this)" data-table="S1" style="width:80px;height:80px;">Snug 1<br>2 seats</button>
  <button onclick="selectTable(this)" data-table="S2" style="width:80px;height:80px;">Snug 2<br>2 seats</button>
  <button onclick="selectTable(this)" data-table="S3" style="width:80px;height:80px;">Snug 3<br>2 seats</button>
</div>

<!-- Booking Form -->
<form id="bookingForm" style="max-width:400px;margin:auto;">
  <input type="hidden" name="table" id="selectedTable" required>
  <label>Date:</label><br>
  <input type="date" id="date" required><br><br>

  <label>Time:</label><br>
  <input type="time" id="time" required><br><br>

  <label>Name:</label><br>
  <input type="text" id="name" required><br><br>

  <label>Contact Number:</label><br>
  <input type="tel" id="contact" required><br><br>

  <label>Email:</label><br>
  <input type="email" id="email" required><br><br>

  <label>Baby Seat?</label><br>
  <select id="babySeat" required>
    <option value="No">No</option>
    <option value="Yes">Yes</option>
  </select><br><br>

  <label>Special Requests:</label><br>
  <textarea id="notes" rows="3" style="width:100%;"></textarea><br><br>

  <button type="submit">Book Now</button>
</form>

<p id="statusMessage"></p>

<script>
const WEBHOOK_URL = "https://script.google.com/macros/s/AKfycbxALplsL1YhvjozZcJrd68-wZ_J8lG0IavP-B9xY26LD8ug7KnTAF5_gOcC3S5Ktp5S/exec";

let selectedButton = null;
function selectTable(btn) {
  if (selectedButton) selectedButton.style.backgroundColor = '';
  btn.style.backgroundColor = '#012C4E';
  btn.style.color = '#fff';
  selectedButton = btn;
  document.getElementById("selectedTable").value = btn.dataset.table;
}

document.getElementById("bookingForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const table = document.getElementById("selectedTable").value;
  const date = document.getElementById("date").value;
  const time = document.getElementById("time").value;
  const name = document.getElementById("name").value;
  const contact = document.getElementById("contact").value;
  const email = document.getElementById("email").value;
  const babySeat = document.getElementById("babySeat").value;
  const notes = document.getElementById("notes").value;

  const data = { table, date, time, name, contact, email, babySeat, notes };

  try {
    await fetch(WEBHOOK_URL, {
      method: "POST",
      headers: { "Content-Type": "text/plain;charset=utf-8" },
      body: JSON.stringify(data),
    });

    emailjs.send("Service_Reservations", "Table_Template", {
      to_email: email,
      to_name: name,
      table: table,
      date: date,
      time: time,
      contact: contact,
    });

    emailjs.send("Service_Reservations", "Table_Template", {
      to_email: "bar918.malkinsbank@gmail.com",
      to_name: "Bar918",
      table: table,
      date: date,
      time: time,
      contact: contact,
    });

    document.getElementById("statusMessage").innerText = "Booking submitted successfully!";
  } catch (err) {
    document.getElementById("statusMessage").innerText = "Error submitting booking.";
    console.error(err);
  }
});
</script>
</body>
</html>
